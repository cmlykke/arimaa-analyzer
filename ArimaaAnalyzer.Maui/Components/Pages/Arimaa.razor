@page "/arimaa"
@using ArimaaAnalyzer.Maui.Services.Arimaa
@using ArimaaAnalyzer.Maui.Components
@using Microsoft.AspNetCore.Components

<ArimaaBoard Game="DemoGame" BoardSettings="PageBoardSettings" />

@code {
    // Dummy game service for manual testing, built from AEI board string.
    private ArimaaGameService DemoGame { get; } = CreateDemo();

    private static ArimaaGameService CreateDemo()
    {
        var board = new[]
        {
            "rrrrrrrr",
            "hdcemcdh",
            "........",
            "........",
            "........",
            "........",
            "HDCMECDH",
            "RRRRRRRR"
        };
        static string BoardToAei(string[] b, string side)
        {
            var flat = string.Join(string.Empty, Array.ConvertAll(b, r => r.Replace('.', ' ')));
            return $"setposition {side} \"{flat}\"";
        }

        var aei = BoardToAei(board, "g");
        var state = new GameState(aei);
        return new ArimaaGameService(state);
    }

    // Board settings are provided by MainLayout via CascadingValue, so
    // this page consumes them without owning the instance.
    [CascadingParameter]
    private ArimaaBoardSettings PageBoardSettings { get; set; } = default!;
}
