@page "/arimaa"
@using ArimaaAnalyzer.Maui.Services.Arimaa

<h1>Arimaa Board</h1>

<div style="margin-bottom: 8px;">
    <button @onclick="ToggleOuterUi">
        Toggle Outer UI (@(PageBoardSettings.ShowOuterUi ? "On" : "Off"))
    </button>
</div>

<ArimaaBoard Game="DemoGame" BoardSettings="PageBoardSettings" />

@code {
    // Dummy game service for manual testing, built from AEI board string.
    private ArimaaGameService DemoGame { get; } = CreateDemo();

    private static ArimaaGameService CreateDemo()
    {
        var board = new[]
        {
            "rrrrrrrr",
            "hdcemcdh",
            "........",
            "........",
            "........",
            "........",
            "HDCMECDH",
            "RRRRRRRR"
        };
        static string BoardToAei(string[] b, string side)
        {
            var flat = string.Join(string.Empty, Array.ConvertAll(b, r => r.Replace('.', ' ')));
            return $"setposition {side} \"{flat}\"";
        }

        var aei = BoardToAei(board, "g");
        var state = new GameState(aei);
        return new ArimaaGameService(state);
    }

    // Example: choose a preset for this page; other pages can pass different settings
    private ArimaaBoardSettings PageBoardSettings { get; } = ArimaaBoardSettings.PlayableLarge;

    private void ToggleOuterUi()
    {
        PageBoardSettings.ShowOuterUi = !PageBoardSettings.ShowOuterUi;
    }
}
